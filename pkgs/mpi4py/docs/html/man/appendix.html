<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Appendix &mdash; MPI for Python v1.0.0 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0.0',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="MPI for Python v1.0.0 documentation" href="index.html" />
    <link rel="prev" title="Tutorial" href="tutorial.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="tutorial.html" title="Tutorial"
             accesskey="P">previous</a></li>
        <li><a href="index.html">MPI for Python v1.0.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="appendix">
<h1>Appendix<a class="headerlink" href="#appendix" title="Permalink to this headline">¶</a></h1>
<div class="section" id="mpi-enabled-python-interpreter">
<span id="python-mpi"></span><h2>MPI-enabled Python interpreter<a class="headerlink" href="#mpi-enabled-python-interpreter" title="Permalink to this headline">¶</a></h2>
<p>Some MPI-1 implementations (notably, MPICH 1) <strong>do require</strong> the
actual command line arguments to be passed at the time
<tt class="xref docutils literal"><span class="pre">MPI_Init()</span></tt> is called. In this case, you will need to use a
rebuilt, MPI-enabled, Python interpreter binary executable. A basic
implementation (targeting Python 2.X) of what is required is shown
below:</p>
<div class="highlight-python"><pre>#include &lt;Python.h&gt;
#include &lt;mpi.h&gt;

int main(int argc, char *argv[])
{
   int status, flag;
   MPI_Init(&amp;argc, &amp;argv);
   status = Py_Main(argc, argv);
   MPI_Finalized(&amp;flag);
   if (!flag) MPI_Finalize();
   return status;
}</pre>
</div>
<p>The source code above is straightforward; compiling it should also
be. However, the linking step is more tricky: special flags have to be
passed to the linker depending on your platform. In order to alleviate
you for such low-level details, <em>MPI for Python</em> provides some
pure-distutils based support to build and install a MPI-enabled Python
interpreter executable:</p>
<div class="highlight-python"><pre>$ cd mpi4py-X.X.X
$ python setup.py build_exe [--home=$HOME]
$ [sudo] python setup.py install_exe</pre>
</div>
<p>After the above steps you should have the re-built interpreter
installed as <tt class="docutils literal"><em><span class="pre">prefix</span></em><span class="pre">/bin/python</span><em><span class="pre">X</span></em><span class="pre">.</span><em><span class="pre">X</span></em><span class="pre">-mpi</span></tt>. Assuming that
<tt class="docutils literal"><em><span class="pre">prefix</span></em><span class="pre">/bin</span></tt> in on your <span class="target" id="index-0"></span><strong class="xref">PATH</strong>, you should be able to
enter your MPI-enabled Python interactively, for example:</p>
<div class="highlight-python"><pre>$ python2.5-mpi
Python 2.5.2 (r252:60911, Sep 30 2008, 15:41:38)
[GCC 4.3.2 20080917 (Red Hat 4.3.2-4)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; import sys
&gt;&gt;&gt; sys.executable
'/usr/bin/python2.5-mpi'
&gt;&gt;&gt;</pre>
</div>
</div>
<div class="section" id="building-mpi">
<span id="id1"></span><h2>Building MPI<a class="headerlink" href="#building-mpi" title="Permalink to this headline">¶</a></h2>
<p>In the list below you have some executive instructions for building
some of the open-source MPI implementations out there with support for
shared/dynamic libraries on POSIX environments.</p>
<ul>
<li><p class="first"><em>MPICH 2</em></p>
<div class="highlight-python"><pre>$ tar -zxf mpich2-X.X.X.tar.gz
$ cd mpich2-X.X.X
$ ./configure --enable-sharedlibs=gcc --prefix=/usr/local/mpich2
$ make
$ make install</pre>
</div>
</li>
<li><p class="first"><em>Open MPI</em></p>
<div class="highlight-python"><pre>$ tar -zxf openmpi-X.X.X tar.gz
$ cd openmpi-X.X.X
$ ./configure --prefix=/usr/local/openmpi
$ make all
$ make install</pre>
</div>
</li>
<li><p class="first"><em>LAM/MPI</em></p>
<div class="highlight-python"><pre>$ tar -zxf lam-X.X.X.tar.gz
$ cd lam-X.X.X
$ ./configure --enable-shared --prefix=/usr/local/lam
$ make
$ make install</pre>
</div>
</li>
<li><p class="first"><em>MPICH 1</em></p>
<div class="highlight-python"><pre>$ tar -zxf mpich-X.X.X.tar.gz
$ cd mpich-X.X.X
$ ./configure --enable-sharedlib --prefix=/usr/local/mpich1
$ make
$ make install</pre>
</div>
</li>
</ul>
<p>Perhaps you will need to set the <span class="target" id="index-1"></span><strong class="xref">LD_LIBRARY_PATH</strong>
environmental variable (using <strong>export</strong>, <strong>setenv</strong> or
what applies to your system) pointing to the directory containing the
MPI libraries . In case of getting runtime linking errors when running
MPI programs, the following lines can be added to the user login shell
script (<tt class="docutils literal"><span class="pre">.profile</span></tt>, <tt class="docutils literal"><span class="pre">.bashrc</span></tt>, etc.).</p>
<ul>
<li><p class="first"><em>MPICH 2</em></p>
<div class="highlight-python"><pre>MPI_DIR=/usr/local/mpich2
export LD_LIBRARY_PATH=$MPI_DIR/lib:$LD_LIBRARY_PATH</pre>
</div>
</li>
<li><p class="first"><em>Open MPI</em></p>
<div class="highlight-python"><pre>MPI_DIR=/usr/local/openmpi
export LD_LIBRARY_PATH=$MPI_DIR/lib:$LD_LIBRARY_PATH</pre>
</div>
</li>
<li><p class="first"><em>LAM/MPI</em></p>
<div class="highlight-python"><pre>MPI_DIR=/usr/local/lam
export LD_LIBRARY_PATH=$MPI_DIR/lib:$LD_LIBRARY_PATH</pre>
</div>
</li>
<li><p class="first"><em>MPICH 1</em></p>
<div class="highlight-python"><pre>MPI_DIR=/usr/local/mpich1
export LD_LIBRARY_PATH=$MPI_DIR/lib/shared:$LD_LIBRARY_PATH:
export MPICH_USE_SHLIB=yes</pre>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">MPICH 1 support for dynamic libraries is not completely
transparent. Users should set the environmental variable
<span class="target" id="index-2"></span><strong class="xref">MPICH_USE_SHLIB</strong> to <tt class="docutils literal"><span class="pre">yes</span></tt> in order to avoid link
problems when using the <strong>mpicc</strong> compiler wrapper.</p>
</div>
</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">Appendix</a><ul>
<li><a class="reference external" href="#mpi-enabled-python-interpreter">MPI-enabled Python interpreter</a></li>
<li><a class="reference external" href="#building-mpi">Building MPI</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="tutorial.html"
                                  title="previous chapter">Tutorial</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/appendix.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="tutorial.html" title="Tutorial"
             >previous</a></li>
        <li><a href="index.html">MPI for Python v1.0.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2009, Lisandro Dalcín.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6b1.
    </div>
  </body>
</html>